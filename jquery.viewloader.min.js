(function(c){"function"!=typeof c.Deferred?alert("view-loader requires jQuery v1.5 or later!  You are using v"+c.fn.jquery):(c.viewloader=function(g,i){var k={logLevel:"none",viewExtension:".view.html",scripts:null,afterEachTemplate:null,success:null,error:null},b=this;b.id=g.id||g.toString();var l=c(g);b.settings={};b.init=function(){b.settings=c.extend({},k,i);b.templates=[];b.loadAllPartialViews()};b.loadAllPartialViews=function(){(b.settings.scripts||l.find("script[src$='"+b.settings.viewExtension+
"']")).each(function(){var a=c(this),d=a.attr("id"),e=a.attr("src");0==c("script[id="+d+"]").length&&c("body").append("<script id='"+d+"' type='text/html'  src='"+e+"' ><\/script>");d=c.Deferred();d.templateID=a.attr("id");d.templateSrc=a.attr("src");d.execute=b.loadSourceForPartialView;b.templates.push(d)});c.when.apply(b,b.templates).done(function(a){b.settings.success?(f("viewloader.loadAllPartialViews executing 'success' function","debug"),b.settings.success(a)):f("viewloader.loadAllPartialViews all done since no 'success' function was provided",
"debug")}).fail(function(a){b.settings.error?(f("viewloader.loadAllPartialViews executing 'error' function","debug"),b.settings.error(a)):f("viewloader.loadAllPartialViews all done since no 'error' function was provided","debug")});for(var a=0;a<b.templates.length;a++){var e=b.templates[a];e.execute(e)}};b.loadSourceForPartialView=function(a){f("viewloader.loadSourceForPartialView loading source for view: id="+a.templateID+" src="+a.templateSrc,"debug");c.ajax({url:a.templateSrc,data:a.templateID,
error:function(b,c,d){f("viewloader.loadSourceForPartialView could not find the view with id: "+a.templateID+" at url: "+a.templateSrc,"error");a.reject(a.templateID+" : "+d.message)},success:function(e,g,d){e=c("#"+a.templateID);if(0==e.length)f("viewloader.loadSourceForPartialView could not find script with id: "+a.templateID,"error"),a.resolve(null);else{f("viewloader.loadSourceForPartialView saving source in "+a.templateID,"debug");var h=d.responseText;e[0].text=h;var j=function(a){if(this.settings.afterEachTemplate){f("viewloader.loadSourceForPartialView execute afterEachTemplate callback for "+
a.templateID,"debug");try{this.settings.afterEachTemplate(a.templateID)}catch(b){f("viewloader.loadSourceForPartialView afterEachTemplate callback for "+a.templateID+" failure: "+b,"error")}}a.resolve(a.templateID)},d=c(h).find("script");0<d.length?(d.each(function(){var a=c(this).attr("id");h=h.replace(a,"_"+a+"_")}),e[0].text=h,e.viewloader({logLevel:"debug",afterEachTemplate:b.settings.afterEachTemplate,scripts:d,success:function(){j.call(b,a)},error:function(){j.call(b,a)}})):j.call(b,a)}}})};
var f=function(a,e){if("none"!=b.settings.logLevel)if(c.browser.mozilla)switch(e){case "debug":try{console.debug(a)}catch(f){}break;case "error":try{console.error(a)}catch(d){}break;case "info":try{console.info(a)}catch(g){}break;default:try{console.debug(a)}catch(j){}}else if(c.browser.msie)try{console.log(a)}catch(i){}};b.init()},c.fn.viewloader=function(g){return this.each(function(){if(void 0==c(this).data("viewloader")){var i=new c.viewloader(this,g);c(this).data("viewloader",i)}})})})(jQuery);