(function(c){"function"!=typeof c.Deferred?alert("view-loader requires jQuery v1.5 or later!  You are using v"+c.fn.jquery):(c.viewloader=function(f,h){var j={logLevel:"none",viewExtension:".view.html",scripts:null,afterEachTemplate:null,success:null,error:null},b=this;b.id=f.id||f.toString();var k=c(f);b.settings={};b.init=function(){b.settings=c.extend({},j,h);b.templates=[];b.loadAllPartialViews()};b.loadAllPartialViews=function(){(b.settings.scripts||k.find("script[src$='"+b.settings.viewExtension+
"']")).each(function(){var a=c(this),d=a.attr("id"),e=a.attr("src");0==c("script[id="+d+"]").length&&c("body").append("<script id='"+d+"' type='text/html'  src='"+e+"' ><\/script>");d=c.Deferred();d.templateID=a.attr("id");d.templateSrc=a.attr("src");d.execute=b.loadSourceForPartialView;b.templates.push(d)});c.when.apply(b,b.templates).done(function(a){b.settings.success?(e("viewloader.loadAllPartialViews executing 'success' function","debug"),b.settings.success(a)):e("viewloader.loadAllPartialViews all done since no 'success' function was provided",
"debug")}).fail(function(a){b.settings.error?(e("viewloader.loadAllPartialViews executing 'error' function","debug"),b.settings.error(a)):e("viewloader.loadAllPartialViews all done since no 'error' function was provided","debug")});for(var a=0;a<b.templates.length;a++){var g=b.templates[a];g.execute(g)}};b.loadSourceForPartialView=function(a){e("viewloader.loadSourceForPartialView loading source for view: id="+a.templateID+" src="+a.templateSrc,"debug");c.ajax({url:a.templateSrc,data:a.templateID,
error:function(b,c,d){e("viewloader.loadSourceForPartialView could not find the view with id: "+a.templateID+" at url: "+a.templateSrc,"error");a.reject(a.templateID+" : "+d.message)},success:function(g,f,d){g=c("#"+a.templateID);if(0==g.length)e("viewloader.loadSourceForPartialView could not find script with id: "+a.templateID,"error"),a.resolve(null);else{e("viewloader.loadSourceForPartialView saving source in "+a.templateID,"debug");d=d.responseText;g[0].text=d;var i=function(a){if(this.settings.afterEachTemplate){e("viewloader.loadSourceForPartialView execute afterEachTemplate callback for "+
a.templateID,"debug");try{this.settings.afterEachTemplate(a.templateID)}catch(b){e("viewloader.loadSourceForPartialView afterEachTemplate callback for "+a.templateID+" failure: "+b,"error")}}a.resolve(a.templateID)},d=c(d).find("script");0<d.length?g.viewloader({logLevel:"debug",afterEachTemplate:b.settings.afterEachTemplate,scripts:d,success:function(){i.call(b,a)},error:function(){i.call(b,a)}}):i.call(b,a)}}})};var e=function(a,e){if("none"!=b.settings.logLevel)if(c.browser.mozilla)switch(e){case "debug":try{console.debug(a)}catch(f){}break;
case "error":try{console.error(a)}catch(d){}break;case "info":try{console.info(a)}catch(i){}break;default:try{console.debug(a)}catch(h){}}else if(c.browser.msie)try{console.log(a)}catch(j){}};b.init()},c.fn.viewloader=function(f){return this.each(function(){if(void 0==c(this).data("viewloader")){var h=new c.viewloader(this,f);c(this).data("viewloader",h)}})})})(jQuery);